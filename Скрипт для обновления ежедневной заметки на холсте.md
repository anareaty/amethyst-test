---
date: 2023-06-07
cssclasses:
  - note
  - show-properties
tags:
  - Obsidian
Тема:
  - "[[Obsidian|Obsidian]]"
Тип: заметка
Раздел: "[[Картотека]]"
Статус заметки:
  - ♻️ переработать
---

Я решила использовать встроенный плагин "Холст" для создания домашней страницы в Обсидиане и помимо прочего добавить на неё ежедневную заметку, чтобы просматривать всё в одном месте. Проблема в том, что ежедневная заметка меняется каждый день, и мне бы хотелось, чтобы на холсте она также автоматически обновлялась. Поэтому я написала такой скрипт для плагина "Templater":


```js
< %*
  let canvasPath = "Главная.canvas"
  let dailyFolder = "Ежедневник/"
  let dailyFormat = "yyyy-MM-DD"

  let today = tp.date.now(dailyFormat)
  let file = await app.vault.getAbstractFileByPath(canvasPath)
  
  if (file != null) {
    let content = await app.vault.read(file)
    if (content != "") {
    
      let data = JSON.parse(content)
      let nodes = data.nodes
      let node = nodes.find(n => {
        if (n.file != undefined) {
          return n.file.startsWith(dailyFolder)
        } else return false
      })
      let todayFilePath = dailyFolder + today + ".md"

      if (node != undefined) {
        if (node.file != todayFilePath) {
          node.file = todayFilePath
          let newContent = JSON.stringify(data)
          await app.vault.modifyBinary(file, newContent)
        }
      }   
	  }
  }
%>
```


Этот скрипт надо сохранить как шаблон в папке для шаблонов в своём хранилище, удалив пробел между "<" и "%\*". В настройках темплейтера этот шаблон надо добавить в поле "Startup Templates". При необходимости в шаблоне надо прописать свои параметры: 
- canvasPath — путь к холсту, который вы хотите обновить;
- dailyFolder — папка, в которой лежат ежедневные заметки;
- dailyFormat — формат заголовка ежедневной заметки.

Теперь, если на указанный холст добавлена ежедневная заметка, то каждый раз при запуске программы она будет автоматически заменяться на сегодняшнюю ежедневную заметку.

Имейте в виду, что:
- если на холсте нет никаких ежедневных заметок, то ничего не произойдёт;
- если на холсте вставлено несколько ежедневных заметок, то обновится только одна;
- чтобы скрипт работал правильно, все ежедневные заметки должны лежать в отдельной папке.