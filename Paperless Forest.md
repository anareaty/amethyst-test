---
date: 2022-01-01
cssclasses:
  - note
Статус заметки:
  - ♻️ переработать
Тема:
  - "[[Obsidian|Obsidian]]"
Тип: заметка
Раздел: "[[Картотека]]"
---

[Paperless Forest](https://paperless-forest.ru/) — мой сайт

Сайт хостится на Github Pages при помощи плагина Github Publisher и шаблона Hugo.

[Репозиторий сайта](https://github.com/anareaty/paperless-forest)
[Репозиторий плагина](https://github.com/ObsidianPublisher/obsidian-github-publisher?tab=readme-ov-file)
[Документация плагина](https://obsidian-publisher.netlify.app)

## Инструкция по настройке

- Локальная настройка Hugo (необязательно)
- Настройка Github
- Настройка плагина

***
Альтернатива: [Quartz](https://github.com/jackyzha0/quartz) (можно использовать вместо шаблона Hugo по тому же принципу)

Я пробовала кварц, но мне не понравился шаблон по умолчанию, а настройка собственного шаблона показалась слишком сложной, поэтому я решила остаться на Hugo.

В частности я не разобралась, как в кварце сделать ленту блога, или сделать так, чтобы меню строилось не на основе папок, а на основе метаданных.









# Как создать бесплатный статический сайт из заметок Obsidian
## Зачем это надо

У приложения Obsidian есть свой собственный встроенный сервис Publish, который позволяет публиковать заметки в интернете, создавая свой "цифровой сад". Плюс этого сервиса в том, что он максимально интегрирован в сам Обсидиан, и там всё работает из коробки. Минус в том, что он платный и достаточно дорогой. Вдобавок, там ограниченные возможности настройки и ограниченный объём.

К счастью есть возможность получить практически весь тот же самый функционал бесплатно, с помощью разных плагинов и сервисов для генерации статических сайтов. К примеру, этот сайт сделан полностью бесплатно, он хостится на Github pages, а новые посты публикуются прямо из Обсидиана в один клик — точно так же, как в сервисе Publish. Минусом такого подхода является необходимость самостоятельно разбираться и ковыряться в настройках, чинить баги, если что-то не работает, и вообще разбираться, как всё работает, вместо того, чтобы просто пользоваться. Для не технарей это может быть сложно. Я не технарь, но кое-что что умею, поэтому разобралась, но со скрипом. С другой стороны, после того, как разберёшся, возможности для настройки сайта открываются безграничные.

Эта статья написана с целью немного упростить эту задачу людям, которые тоже хотят создать такой сайт, но не могут найти внятную инструкцию. Мне пришлось много гуглить и тестировать, прежде чем у меня всё получилось, так что хотелось бы обобщить свой опыт, чтобы другим было проще.

Я не буду описывать все способы создания сайта из Обсидиана, потому что их много и я не все из них тестировала. Я расскажу только, как устроен этот конкретный сайт и как можно сделать точно такой же.

## 

Немного о том, как это работает

Любой сайт должен где-то хостится, то есть, располагаться на сервере, который хранит у себя странички и показывает их в интернете. В моём случае роль хостинга выполняет сервис Github Pages — странички хранятся на Гитхабе, и Гитхаб сам автоматически собирает из них сайт. Это бесплатно, удобно и для небольшого некоммерческого сайта вполне достаточно.

Чтобы из Обсидиана отправлять заметки на Гитхаб, можно использовать гит, но проще и удобнее это делать с помощью специального плагина для Обсидиана Github Publisher. Он не только позволяет отправлять заметки одной кнопкой, но и раскладывает их по нужным папкам, переименовывает, преобразует ссылки, загружает картинки, и делает ещё кучу всяких полезных мелочей.

Ещё один нюанс заключается в том, что заметки мы пишем на языке разметки Markdown, тогда как станицы для сайта должны быть написаны на Html. Причём мало просто преобразовать Markdown-заметку в Html — нужно ещё добавить к страничке навигацию, бэклинки, скрипты, стили. оглавление и т. п. — в общем, сделать из неё полноценную страницу сайта. Руками всё это делать неудобно, поэтому для этого всего существуют специальные скрипты и шаблоны. Я использую шаблон, написанный на языке Hugo. Он тоже лежит на Гитхабе, рядом с заметками, и при добавлении новой заметки автоматически преобразует её в Html-страницу нужного формата.

Таким образом, процесс добавления новой записи на сайт происходит так:

1. Я пишу заметку в Обсидиане и проставляю все необходимые метаданные.
2. Я вызываю команду для публикации заметки.
3. Плагин Github Publisher отправляет заметку на Гитхаб.
4. На Гитхабе без моего участия происходит какая-то магия, преобразующая заметку в страницу (обычно нужно с полминуты подождать).
5. Страница появляется на сайте.

Как видите, сам процесс очень простой и удобный — при условии, что всё настроено как надо и ничего не ломается. Ну а теперь я наконец расскажу о том, как настроить, чтобы это всё работало.

## 

Настройка

### 

Настройка сайта

Во первых, вам понадобится аккаунт на Гитхабе, так что, если у вас его ещё нет, следует его создать. Тут ничего сложного нет, такая же регистрация, как на любом сайте.

Во-вторых, нужно выбрать шаблон. Шаблон определяет внешний вид сайта, например, будет ли в нём панель навигации, в каком порядке будут располагаться странички, по каким правилам Markdown будет преобразовываться в Html и так далее. Шаблонов в интернете очень много (например, вот библиотека шаблонов Хьюго), но не все они подходят для Обсидиана, потому что в синтаксисе Обсидиана есть свои фишечки. Лучше всего взять такой шаблон, в котором указано, что он создавался специально для Обсидиана. Я изначально выбрала шаблон Аметист, но потом ещё очень сильно переделала его под себя. Те, кто умеет программировать, могут написать свой собственный шаблон, но для новичка это может быть сложно, хотя, если поковыряться, можно изменить какие-то мелкие детали. Если хотите сделать точно такой сайт как у меня, можно использовать мой шаблон. Взять его можно здесь, но сразу предупреждаю, что код там местами кривоватый. Дальше я буду всё объяснять на примере моего шаблона.

После того, как шаблон выбран, его нужно скопировать. Для этого открываете репозиторий шаблона на Гитхабе, нажимаете кнопку fork и пишете имя собственного репозитория. Это и будет репозиторий вашего сайта.

Теперь нужно собственно создать сайт. Для этого в репозитории открываете вкладку branches и создаёте новую ветку под названием deploy. Затем в настройках репозитория открываете вкладку Settings -> Pages. В разделе Build and deployment выбираете Source: Deploy from a branch и Branch: deploy. Вскорее после этого наверху страницы Pages должна появиться ссылка на ваш новый сайт. Его можно открыть, но там пока ещё ничего нет.

Кроме того может понадобиться в настройках репозитория открыть вкладку Settings -> Actions -> General и включить там все разрешения, потому что они могут быть выключены по умолчанию. В разделе Actions permissions выбираете Allow all actions and reusable workflows, а в разделе Workflow permissions — Read and write permissions.

Далее, чтобы на сайте что-то появилось, нужно настроить ваш шаблон, а для этого отредакировать файл конфигурации. Удобнее редактировать файлы, склонировав их на свой компьютер через гит, но если вы не разбираетесь в гите, можно редактировать прямо на Гитхабе. В моём шаблоне требуется отредактировать файл config.yaml. В этом файле вы заменяете все мои данные на свои: указываете своё имя, название сайта, свои ссылки и т. п. Самое главное — обязательно изменить поле baseURL и указать там ссылку на ваш сайт, в противном случае шаблон не будет работать. Пока вы не подключили свой домен, ссылка на ваш сайт будет выглядеть следующим образом: https://ваш-логин.github.io/название-репозитория. Например, ссылка на мой сайт выглядела так: [https://anareaty.github.io/paperless-forest](https://anareaty.github.io/paperless-forest).

После этого сайт должен заработать, правда, сначала вы на нём увидите только те страницы, которые изначально есть в шаблоне. Обратите внимание, как генерируются страницы сайта: в ветке main в репозитории есть папка content, в неё можно добавлять файлы в формате .md, после чего они преобразуются в файлы в формате .html и добавляются в ветку deploy, а уже на основании ветки deploy создаётся сайт. Не стоит пытаться редактировать ветку deploy вручную — все изменения делаются только в ветке main.

Если сайт не работает, убедитесь, что в вашем репозитории присутствует файл deploy.yaml, он должен лежать в папке .github/workflows. Если его нет, можно добавить его вручную и скопировать в него код отсюда.

## 

Настройка плагина

Теперь, когда сайт работает можно переходить к настройке добавления на него страниц из Обсидиана.

Прежде всего, следует создать токен для авторизации. Для этого переходим на страницу [https://github.com/settings/personal-access-tokens](https://github.com/settings/personal-access-tokens) и генерируем новый токен. Токен может быть постоянный или временный, кроме того он может быть с доступом ко всем репозиториям или только к некоторым. Там ещё очень много других настроек разрешений, в которых сложно разобраться. Лично я не заморачивалась а просто сделала постоянный токен со всеми разрешениями, но только для одного конкретного репозитория сайта. Токен нужно сразу скопировать, потому что он показывается только один раз.

Затем в Обсидиане надо установить плагин Github Publisher. В настройках плагина указываем свой юзернейм на Гитхабе, название репозитория и скопированный токен. Там есть ещё много других настроек, которые зависят от конкретного шаблона и желаемой конфигурации. Если хотите скопировать мои настройки, можно скачать этот файл и положить его в папку плагина.

Теперь можно публиковать заметки из Обсдиана, но перед публикацией к ним нужно добавить специальные свойства. Какими должны быть эти свойства, зависит от используемого шаблона и настроек плагина, поэтому я опишу только вариант для моего сетапа.

Вот такие свойства я использую:

- share: true (обязательное свойство, которое говорит плагину, что заметку нужно опубликовать);
- path: content (указывается папка в репозитории, куда будут отправляться заметки; можно использовать вложенные папки, например, content/obsidian и т. п., но начинаться путь непременно должен с папки content, потому что именно из неё наш шаблон берёт странички);
- filename: some-name (указывается имя файла будущей страницы; желательно записывать его английскими буквами и с девисами вместо пробелов, чтобы ничего не перекосячилось);
- title: Заголовок страницы (указывается заголовок, который будет отображаться на сайте; его уже можно записывать и русскими буквами);
- date: 2023-12-19 (дата в формате YYYY-MM-DD. Если страницы добавляются в ленту блога, они будут отсортированы по дате, а если написать завтрашнюю дату, то заметка опубликуется только завтра);
- meny: true (указывает, что страница должна отображаться в боковой панели);
- blog: true (указывает, что страница должна отображаться в ленте блога);
- toc: true (указывает, что на странице должно быть оглавление — полезно только для страниц с заголовками);
- collapse: true (если страница является индексной страницей папки, указывает, что эта папка должна сворачиваться);
- weight: 1 (указвает порядок расположения страниц в боковой панели).

Метаданных получается довольно много, так что я советую сделать для них в Обсидиане шаблон.

Ещё немного о структуре папок. Папка content является корневой папкой для всех заметок, добавляемых в репозиторий, но в неё можно добавлять папки и подпапки. Эта структура папок будет отображаться в боковой панели. При этом важно, что внутри каждой папки непременно должна лежать индексная заметка с названием _index.md, иначе эта папка со всеми находящимися в ней заметками не будет отображаться в меню (хотя это может быть полезно. если вы хотите сделать какую-то скрытую папку). Внутри самой корневой папки content тоже должна быть заметка _index.md, и она, собственно, является главной страницей сайта. Вообще я рекомендую заранее продумать структуру папок, потому что изменять её потом довольно неудобно.

Также хочу обратить внимание на форматирование ссылок. Можно использовать как маркдаун-ссылки, так и вики-ссылки, но у всех внутренних ссылок в заметке обязательно нужно указывать алиасы, иначе вместо названия страныцы в ссылке будет указано название имени файла (то самое, которое с английскими буквами).

Если вы используете не мой шаблон, а какой-нибудь другой, необходимые метаданные там могут быть другими, как и устройство структуры папок. В таком случае почитайте документацию к конкретному шаблону, там обычно всё описано. К сожалению, к моему шаблону пока нет документации, кроме этой статьи и документации Аметиста, которая уже наполовину не подходит, потому что я всё поменяла..

После того, как все метаданные заполнены, заметку можно публиковать! Вызываем команду Github Publisher: Upload single current active note (чтобы опубликовать текущую заметку) или любую из нескольких команд для публикации сразу нескольких заметок, и через минуту страница появится на сайте!

## 

Дебаггинг

Если вы вызываете команду, а страница не публикуется, этому может быть несколько причин.

Во-первых, проблема может быть в плагине. Обычно он выдаёт уведомление о том, что заметка успешно опубликовалась. Если уведомления нет или есть уведомление об ошибке, можно нажать Ctrl + Shift + I и открыть панель разработчика, где прочитать более подробное описание, что пошло не так. В моём опыте ошибки иногда возникали из-за неправильного форматирования метаданных, так что будет полезно их перепроверить.

Во-вторых, проблема может быть в шаблоне. Если вы откроете репозиторий и увидите, что заметка появилась в папке content, но на сайте её нет, возмжно, возникла какая-то ошибка во время её преобразования. В таком случае можно открыть в репозитории вкладку Actions, где отображаются автоматические процессы. Если вы видите там красный крестик вместо зелёной галочки, значит, процесс завершился с ошибкой. Можно открыть его и прочитать описание ошибки.

Наконец, страница может не публиковаться из-за неправильной даты (если вы случайно указали дату в будущем) или ещё каких-то ошибок в метаданных.

## 

Редактирование шаблона

Вам может захотеться немного отредактировать сам шаблон. Или, как минимум. возможно вы захотите изменить css сайта (все css-файлы находятся в папке assets), чтобы настроить внешний вид как вам хочется. Но на живом сайте это делать неудобно, потому что после каждого изменения придётся по полминуты ждать, пока всё задеплоится, чтобы посмотреть результат. Для редактирования гораздо удобнее запустить локальную версию сайта. Для этого нужно:

- установить git;
- установить hugo;
- склонировать репозиторий в локальную папку на компьютере;
- перейти в эту папку в терминале;
- запустить в терминале команду hugo server;
- открыть ссылку, которая появится в терминале.

Теперь у вас есть локальная версия сайта, и локальные изменения в файлах репозитория будут сразу же в ней отображаться. Можно всё настроить, и потом уже отправлять результат обратно на Гитхаб. Я не буду описывать подробно, как всё это делается, потому что это всё равно уже вариант для тех, кто хоть что-то понимает в программировании.

## 

Подключение комментариев

Поскольку сайт статический, он не может самостоятельно обрабатывать комментарии. Но можно добавить к нему какой-нибудь сторонний сервис для комментариев.

На своём сайте я использую комментарии Гитхаба. Как их подключить, описывается вот здесь.

## 

Подключение своего домена

Вообще покупать свой домен необязательно — можно просто использовать домен Гитхаба. Но при желании свой собственный домен подключить несложно. Вот здесь лежит самая внятная инструкция для этого, которую я нашла.
